
#!update=2025-12-06

[mitm]
# 仅解密这三个核心域名，其他全部忽略，大幅降低 CPU 占用
hostname = grpc.biliapi.net,app.bilibili.com, api.live.bilibili.com

[rewrite_local]

# ==========================================
# 1. 唯一保留的脚本 (核心去广)
# ==========================================
# 只有为了去除"视频流/动态/评论区"里混入的广告，才允许 CPU 运行脚本
# 这一条无法省去，否则视频里全是广告
^https?:\/\/(app\.bilibili\.com|grpc\.biliapi\.net)\/bilibili\.(app\.(dynamic\.v2\.Dynamic\/DynAll|view(unite)?\.v1\.View\/(View|ViewProgress)|playurl\.v1\.PlayURL\/PlayView)|community\.service\.dm\.v1\.DM\/DmView|main\.community\.reply\.v1\.Reply\/MainList)$ url script-response-body https://raw.githubusercontent.com/zirawell/R-Store/main/Res/Scripts/AntiAd/bilibiliProtoA.js

# ==========================================
# 2. 路径级拒绝 (零脚本，低功耗)
# ==========================================
# 既然不能整容(改JSON)，那就直接把广告请求杀掉
# 相比运行脚本，Reject 几乎不发热

# [开屏广告] 直接拒绝数据包
^https?:\/\/app\.bilibili\.com\/x\/v2\/splash\/(list|show|event\/list2)\? url reject-dict
^https?:\/\/[\d\.]+:8000\/v1\/resource\/\w{32}-1-SPLASH url reject-dict

# [搜索净化] 拒绝默认搜索词、热搜发现
^https?:\/\/(app\.bilibili\.com|grpc\.biliapi\.net)\/bilibili\.app\.interface\.v1\.Search\/DefaultWords url reject-dict
^https?:\/\/app\.bilibili\.com\/x\/v\d\/search\/defaultwords url reject-dict
^https?:\/\/app\.bilibili\.com\/x\/v2\/search\/square url reject-dict

# [界面净化] 拒绝红点、活动图标、右上角浮窗
^https?:\/\/app\.bilibili\.com\/x\/resource\/top\/activity url reject-dict
^https?:\/\/api\.bilibili\.com\/x\/v2\/dm\/qoe\/show\? url reject-dict

# [直播净化] 拒绝直播间右下角购物车
^https?:\/\/api\.live\.bilibili\.com\/xlive\/e-commerce-interface\/v\d\/ecommerce-user\/get_shopping_info\? url reject-dict

# [隐私保护] 拒绝IP定位、数据追踪 (防止后台偷偷上传数据耗电)
^https?:\/\/api\.bilibili\.com\/x\/web-interface\/zone\?jsonp url reject-dict
^https?:\/\/app\.bilibili\.com\/x\/resource\/ip url reject-dict
^https:\/\/api\.bilibili\.com\/x\/pd-proxy\/tracker\? url reject-dict
