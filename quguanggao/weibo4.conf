#!name=Weibo_极简强力版_v3
#!desc=修复发现页模块残留问题。采用双脚本策略：Main净化信息流，Ads净化发现页。

[mitm]
hostname = api.weibo.cn, m.api.weibo.cn, *.weibo.cn, *.weibo.com, weibo.com

[rewrite_local]

# ==========================================
# 1. 域名级拒绝 (0 CPU占用，最省电)
# ==========================================
^https?:\/\/(fastimage|adimg|sdkapp|wbapp)\.uve\.weibo\.com url reject
^https?:\/\/.*(promote|game|adimg|analytics|s?ads?|alitui)\.(biz|uve|vue|mcp)?\.weibo\.(c(n|om)|com\.cn) url reject
^https?:\/\/.*\.gridsumdissector\.com url reject
^https?:\/\/beacon\.sina\.com\.cn url reject

# ==========================================
# 2. 发现页/搜索页 专属净化 (核心修复)
# ==========================================
# 这里不再Reject，而是调用奶思专用的 weibo_ads.js 脚本
# 它会精细地把热搜榜上面的“图标”、“Banner”、“营销模块”删掉，只保留榜单
# 对应接口：发现页(finder/container_discover)、热搜页(container_timeline)、超话页
^https?:\/\/m?api\.weibo\.c(n|om)\/2\/(search\/(finder|container_timeline|container_discover)|page|flowpage|searchall|statuses\/(container_timeline_topicpage|container_timeline_topic|container_detail|extend)) url script-response-body https://raw.githubusercontent.com/fmz200/wool_scripts/main/Scripts/weibo/weibo_ads.js

# ==========================================
# 3. 首页信息流 专属净化
# ==========================================
# 这里依然使用 weibo_main.js，因为它处理Timeline信息流最稳
# 对应接口：首页信息流、个人主页、评论区、消息
^https?:\/\/m?api\.weibo\.c(n|om)\/2\/(cardlist|messageflow|statuses\/(unread_)?friends(\/|_)timeline|groups\/timeline|statuses\/(container_timeline_hot|unread_hot_timeline|video_mixtimeline|repost_timeline)|profile\/(me|container_timeline)|video\/(community_tab|remind_info|tiny_stream_video_list)|checkin\/show|(\!/)?live\/media_homelist|comments\/build_comments|container\/get_item) url script-response-body https://raw.githubusercontent.com/fmz200/wool_scripts/main/Scripts/weibo/weibo_main.js

# ==========================================
# 4. 辅助与杂项拒绝
# ==========================================
# 开屏处理
^https?:\/\/(sdk|wb)app\.uve\.weibo\.com(\/interface\/sdk\/sdkad\.php|\/wbapplua\/wbpullad\.lua) url script-response-body https://raw.githubusercontent.com/zmqcherish/proxy-script/main/weibo_launch.js
# 皮肤处理 (可选)
^https?:\/\/api\.weibo\.c(n|om)\/2\/!\/client\/light_skin url script-response-body https://raw.githubusercontent.com/zmqcherish/proxy-script/main/weibo_main.js

# 垃圾拒收
^https?:\/\/boot(realtime|preload)\.uve\.weibo\.com\/v\d\/ad\/(realtime|preload) url reject-dict
^https?:\/\/sdkapp\.uve\.weibo\.com\/interface\/sdk\/(get-lbs-cell-info\.php|sdkconfig\.php) url reject-dict
^https?:\/\/m?api\.weibo\.c(n|om)\/2\/(push\/active|client\/addlog_batch|ad\/preload|push\/info|!\/huati\/discovery_home_bottom_channels|!\/chaohua\/discovery\/home_bottom\/switch|!\/was\/finder\/searchbarchange|!\/huati\/discovery_home_bottom_getdotinfo) url reject-dict
# 搜索框默认词、热搜推荐 (这些还是直接拒收比较干净)
^https?:\/\/m?api\.weibo\.c(n|om)\/2\/search\/defaultwords url reject-dict
^https?:\/\/m?api\.weibo\.c(n|om)\/!\/sug\/list\/finderchange url reject-dict
^https?:\/\/m?api\.weibo\.c(n|om)\/\d\/push\/daily url reject-dict
